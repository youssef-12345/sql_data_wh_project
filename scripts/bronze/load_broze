create or alter procedure bronze.loade_bronze as
begin 
DECLARE @start_time DATETIME, @end_time DATETIME
begin try
	set @start_time = GETDATE()
	truncate table bronze.crm_cust_info;

	bulk insert bronze.crm_cust_info
	from 'C:\Users\Dell\Desktop\sql-data-warehouse-project\datasets\source_crm\cust_info.csv'
	with(
	firstrow=2,
	fieldterminator = ','
	);

	truncate table bronze.crm_cust_info;

	bulk insert bronze.crm_prd_info
	from 'C:\Users\Dell\Desktop\sql-data-warehouse-project\datasets\source_crm\prd_info.csv'
	with(
	firstrow=2,
	fieldterminator = ','
	);

	truncate table bronze.crm_sales_details;

	bulk insert bronze.crm_sales_details
	from 'C:\Users\Dell\Desktop\sql-data-warehouse-project\datasets\source_crm\sales_details.csv'
	with(
	firstrow=2,
	fieldterminator = ','
	);

	truncate table bronze.erp_cust_az12;

	bulk insert bronze.erp_cust_az12
	from 'C:\Users\Dell\Desktop\sql-data-warehouse-project\datasets\source_erp\cust_az12.csv'
	with(
	firstrow=2,
	fieldterminator = ','
	);

	truncate table bronze.erp_loc_a101;

	bulk insert bronze.erp_loc_a101
	from 'C:\Users\Dell\Desktop\sql-data-warehouse-project\datasets\source_erp\loc_a101.csv'
	with(
	firstrow=2,
	fieldterminator = ','
	);

	truncate table bronze.erp_px_cat_g1v2;

	bulk insert bronze.erp_px_cat_g1v2
	from 'C:\Users\Dell\Desktop\sql-data-warehouse-project\datasets\source_erp\px_cat_g1v2.csv'
	with(
	firstrow=2,
	fieldterminator = ','
	);
	 set @end_time = GETDATE()
	 PRINT ' Total Load Duration: ' + CAST(DATEDIFF(SECOND,@start_time, @end_time) AS NVARCHAR) + ' seconds';
end try

begin catch
print 'it is an error in excuting your code' + error_message()
end catch
end
exec bronze.loade_bronze;
